
version: '2'

services:
  nifi:
   image: tmacomms/fuse-nifi:latest
    # image: tmacregistry-tmacomms.azurecr.io/tmacomms/fuse-nifi:latest
   build:
      context: .
      dockerfile: Dockerfile
   ports:
      - 8081/tcp
      - 8011:8080/tcp
      - 8443/tcp
   volumes:
        #- /tempdata/:/tempdata/:rw
        #- /config/nifi/config/:/opt/nifi/config/
        - /logs/nifi:/opt/nifi/logs:rw
        - /config/nifi/shared/datafiles/:/opt/datafiles/
        - /config/nifi/shared/scriptfiles/:/opt/scriptfiles/
        - /config/nifi/shared/certfiles/:/opt/certfiles/
        - /config/nifi/archives/:/tmac/archives/:rw
        - /config/nifi/templates/:/tmac/templates/:rw
        - /config/nifi/flow/:/tmac/flow/:rw
  # volumes_from: 
 #   - nifi-datavolume
   labels:
       io.rancher.container.hostname_override: "container_name"
       io.rancher.container.pull_image: always
   environment:
      - CONF_INTERVAL=10
      - NIFI_HOME=/opt/nifi      
   restart: always
   privileged: true
   stdin_open: true
   tty: true


 # nifi-datavolume:
 #  labels:
#     io.rancher.container.hostname_override: container_name
#     io.rancher.container.start_once: "true"
#   volumes:
#      - /tmac/archives/
#      - /tmac/templates/
   #entrypoint: /bin/true
##   image: tmacomms/fuse-nifi:latest




#  data-nifirepos:
#   image: busybox
#   command: /bin/echo
#   volumes: 
#     - nifi-repos:/opt/nifi/flowfile_repository
#     - nifi-repos:/opt/nifi/database_repository
#     - nifi-repos:/opt/nifi/provenance_repository
##     - nifi-repos:/opt/nifi/content_repository

#  data-userconfig:
#   image: busybox
#   command: /bin/echo
#   volumes:
#     - nifi-userconfig:/opt/datafiles
#     - nifi-userconfig:/opt/scriptfiles
#     - nifi-userconfig:/opt/certfiles

  
    
